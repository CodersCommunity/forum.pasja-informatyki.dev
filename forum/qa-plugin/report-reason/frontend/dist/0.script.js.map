{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./src/ajaxService.js","webpack:///./src/misc.js","webpack:///./src/popupController.js","webpack:///./src/popupFactory.js","webpack:///./src/unFlagButton.js"],"names":["AJAX_TIMEOUT_REASON","TIMEOUT","URL","CONTENT_TYPE","sendAjax","data","Promise","resolve","reject","timeoutId","setTimeout","fetch","method","headers","body","JSON","stringify","then","value","clearTimeout","console","warn","json","FLAG_REASONS_METADATA","NOTICE_LENGTH","POPUP_LABELS","swapElement","referenceNode","html","tmpParent","document","createElement","innerHTML","newElement","removeChild","firstElementChild","parentNode","insertBefore","remove","elementsHTMLMap","Map","reasonKey","reasonValue","index","isLast","textAreaDOM","listItemsDOM","HEADER","NO_REASON_CHECKED","CANCEL","SEND","REPORT_SENT","CLOSE","reportReasonPopupDOMWrapper","reportReasonPopup","reportReasonPopupDOMReferences","reportReasonPopupForm","customReportReason","reportReasonSuccessInfo","requirableFormElements","reportReasonValidationError","questionViewMeta","querySelector","BTN_NAME_SUFFIXES_REGEX","FLAG_BTN_NAME_SUFFIX","reportFlagMap","regex","question","answer","comment","doComment","getPostIdFromInputName","postType","inputName","match","postId","recognizeInputKindByName","Object","entries","find","regexKey","regexValue","test","mappedInputNameRegexKey","collectForumPostMetaData","flagButtonDOM","name","postRootSource","form","getAttribute","postMetaData","questionId","split","slice","bootstrapUsed","showReportReasonPopup","originalFormActionAttribute","action","classList","add","hideReportReasonPopup","reset","bootstrapReportReasonPopup","initOffClickHandler","initReasonList","initButtons","initPopupContainer","handler","reportReasonFlagButtonHandler","event","target","endsWith","preventDefault","stopPropagation","handleFlagClick","addEventListener","checkDOMElementsId","DOMElement","id","clickedOutsidePopup","composedPath","some","reasonList","children","length","contains","focus","bind","cancelButton","sendButton","submitForm","closeReportReasonSentInfo","popupContainer","appendChild","blur","isFormValid","validateForm","toggleSendWaitingState","formData","prepareFormData","response","onAjaxSuccess","ajaxError","onAjaxError","updateCurrentPostFlags","currentFlags","getUnFlagButtonHTML","parentId","getPostParentId","showSuccessPopup","isAnyFormElementUsed","element","isCheckedRadioInput","type","checked","isFilledTextArea","tagName","toLowerCase","notifyAboutValidationError","reportMetaData","FormData","getAll","reasonId","notice","reportType","buttonReference","isWaiting","disabled","window","qa_show_waiting_after","qa_hide_waiting","currentFlagsHTML","flagsMetadataWrapper","targetElementSelector","targetElement","outerHTML","responseAsDOM","DOMParser","parseFromString","parentElement","closest","indexOf","REASON_LIST","reduce","listItems","flagReasonsCollection","get","popupWrapper","querySelectorAll","namePrefix","onclick","nameSuffix","title","clazz","Error"],"mappings":"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","file":"0.script.js","sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","const AJAX_TIMEOUT_REASON = 'AJAX_TIMEOUT';\nconst TIMEOUT = 5000;\n\nconst URL = '/report-flag';\nconst CONTENT_TYPE = 'application/json';\n\nconst sendAjax = (data) => {\n\treturn new Promise((resolve, reject) => {\n\t\tconst timeoutId = setTimeout(() => {\n\t\t\treject(AJAX_TIMEOUT_REASON);\n\t\t}, TIMEOUT);\n\n\t\tfetch(URL, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': CONTENT_TYPE,\n\t\t\t},\n\t\t\tbody: JSON.stringify(data),\n\t\t}).then(async (value) => {\n\t\t\tclearTimeout(timeoutId);\n\n\t\t\t// let text = null;\n\t\t\t// if (purpose === AJAX_PURPOSE.UN_FLAG) {\n\t\t\t//   try {\n\t\t\t//     text = await value.text();\n\t\t\t//   } catch ( e ) {\n\t\t\t//     console.error( 'value.text not worked... /e: ', e );\n\t\t\t//   }\n\t\t\t// }\n\n\t\t\tconsole.warn('fetch response: ', value /*, ' /?:', text*/);\n\n\t\t\t// const resolveValue = purpose === AJAX_PURPOSE.FLAG ? value.json() : 'ok';\n\t\t\tresolve(value.json());\n\t\t});\n\t});\n};\n\nexport default sendAjax;\n","const { NOTICE_LENGTH, POPUP_LABELS } = FLAG_REASONS_METADATA;\n\nexport const swapElement = (referenceNode, html) => {\n\tconst tmpParent = document.createElement('div');\n\ttmpParent.innerHTML = html;\n\n\tconst newElement = tmpParent.removeChild(tmpParent.firstElementChild);\n\treferenceNode.parentNode.insertBefore(newElement, referenceNode);\n\treferenceNode.remove();\n\n\t// return newElement;\n};\n\nexport const elementsHTMLMap = new Map([\n\t[\n\t\t'textarea',\n\t\t`<textarea id=\"customReportReason\"\n\t\t\tclass=\"report-reason-popup__custom-report-reason\"\n\t\t\tname=\"reportReason\"\n\t\t\tdata-requirable=\"true\"\n\t\t\tmaxlength=\"${NOTICE_LENGTH}\"\n\t\t\trows=\"3\"\n\t\t\tcols=\"47\"></textarea>`,\n\t],\n\t[\n\t\t'getListItem',\n\t\t({ reasonKey, reasonValue, index, isLast, textAreaDOM }) => {\n\t\t\treturn `\n\t\t\t\t<!-- TODO: handle checking inputs while tabbing -->\n\t\t\t\t<li tabindex=\"1\">\n\t\t\t\t\t<label for=\"${reasonKey}\">\n\t\t\t\t\t\t<input id=\"${reasonKey}\" \n\t\t\t\t\t\t\t\ttype=\"radio\" \n\t\t\t\t\t\t\t\tvalue=\"${index}\" \n\t\t\t\t\t\t\t\tname=\"reportReason\" \n\t\t\t\t\t\t\t\tdata-requirable=\"true\">\n\t\t\t\t\t\t${reasonValue}\n\t\t\t\t\t</label>\n\t\t\t\t\t${isLast ? textAreaDOM : ''}\n\t\t\t\t</li>\n\t\t\t`;\n\t\t},\n\t],\n\t[\n\t\t'getPopupWrapper',\n\t\t(listItemsDOM) => {\n\t\t\treturn `\n\t\t\t\t<div id=\"reportReasonPopup\" class=\"report-reason-popup\">\n\t\t\t\t\t<p>${POPUP_LABELS.HEADER}</p>\n\t\t\t\t\t\n\t\t\t\t\t<form method=\"post\" class=\"report-reason-popup__form\">\n\t\t\t\t\t\t<ul id=\"reportReasonList\" class=\"report-reason-popup__list\">${listItemsDOM}</ul>\n\t\t\t\t\t\n\t\t\t\t\t\t<p id=\"reportReasonValidationError\" class=\"report-reason-popup__validation-error\">${POPUP_LABELS.NO_REASON_CHECKED}</p>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<!-- TODO: why its input not button? -->\n\t\t\t\t\t\t<input id=\"cancelReportReason\" type=\"button\" value=\"${POPUP_LABELS.CANCEL}\" class=\"report-reason-popup__button report-reason-popup__button--cancel\">\n\t\t\t\t\t\t<button id=\"sendReportReason\" type=\"submit\" class=\"report-reason-popup__button report-reason-popup__button--save\">${POPUP_LABELS.SEND}</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"reportReasonSuccessInfo\" class=\"report-reason-popup__success-info\">\n\t\t\t\t\t${POPUP_LABELS.REPORT_SENT}\n\t\t\t\t\t<button id=\"closeReportReasonSentInfo\" class=\"report-reason-popup__button report-reason-popup__button--close\" type=\"button\">${POPUP_LABELS.CLOSE}</button>\n\t\t\t\t</div>`;\n\t\t},\n\t],\n]);\n","import sendAjax from './ajaxService';\nimport { reportReasonPopupDOMWrapper, reportReasonPopupDOMReferences } from './popupFactory';\nimport getUnFlagButtonHTML from './unFlagButton';\nimport { swapElement } from './misc';\n\nconsole.warn('reportReasonPopupDOMWrapper: ', reportReasonPopupDOMWrapper);\n\nconst {\n\treportReasonPopup,\n\treportReasonPopupForm,\n\tcustomReportReason,\n\treportReasonSuccessInfo,\n\trequirableFormElements,\n\treportReasonValidationError,\n} = reportReasonPopupDOMReferences;\nconst questionViewMeta = document.querySelector('.qa-q-view-meta');\n\nconst BTN_NAME_SUFFIXES_REGEX = /do(clear|un)?flag[s]?/;\nconst FLAG_BTN_NAME_SUFFIX = 'doflag';\n// const doCommentInputNameSuffix = '_docomment';\nconst reportFlagMap = {\n\tregex: {\n\t\tquestion: /q_doflag/,\n\t\tanswer: /^a(\\d+)_doflag/,\n\t\tcomment: /^c(\\d+)_doflag/,\n\t\tdoComment: /^a(\\d+)_docomment/,\n\t},\n\tgetPostIdFromInputName(postType, inputName) {\n\t\t// TODO: check if it works (changed exec to match)...\n\t\tconst [, postId] = inputName.match(this.regex[postType]);\n\t\treturn postId;\n\t},\n\trecognizeInputKindByName(inputName) {\n\t\tconst [mappedInputNameRegexKey] = Object.entries(this.regex).find(([regexKey, regexValue]) =>\n\t\t\tregexValue.test(inputName)\n\t\t);\n\t\treturn mappedInputNameRegexKey;\n\t},\n\tcollectForumPostMetaData() {\n\t\tconst postType = this.recognizeInputKindByName(flagButtonDOM.name);\n\t\tconst postRootSource = flagButtonDOM.form.getAttribute('action');\n\t\tconst postMetaData = {\n\t\t\tquestionId: postRootSource.split('/')[1],\n\t\t\tpostType: postType.slice(0, 1),\n\t\t};\n\t\tpostMetaData.postId = this.getPostIdFromInputName(postType, flagButtonDOM.name) || postMetaData.questionId;\n\n\t\t// if (postType === 'answer') {\n\t\t//   postMetaData.answerId = this.getPostIdFromInputName(\n\t\t//     'answer',\n\t\t//     flagButtonDOM.name\n\t\t//   );\n\t\t// } else if (postType === 'comment') {\n\n\t\t// const doCommentInputDOM = flagButtonDOM.parentElement.querySelector(\n\t\t//   `[name*=\"${doCommentInputNameSuffix}\"]`\n\t\t// );\n\t\t// postMetaData.answerId = this.getPostIdFromInputName(\n\t\t//   'doComment',\n\t\t//   doCommentInputDOM.name\n\t\t// );\n\n\t\t//   postMetaData.commentId = this.getPostIdFromInputName(\n\t\t//     'comment',\n\t\t//     flagButtonDOM.name\n\t\t//   );\n\t\t// }\n\n\t\treturn postMetaData;\n\t},\n};\n\nlet bootstrapUsed = false;\nlet flagButtonDOM = null;\n\nconst showReportReasonPopup = (originalFormActionAttribute) => {\n\treportReasonPopupForm.action = originalFormActionAttribute;\n\treportReasonPopupDOMWrapper.classList.add('report-reason-wrapper--show');\n};\nconst hideReportReasonPopup = () => {\n\treportReasonSuccessInfo.classList.remove('report-reason-popup__success-info--show');\n\treportReasonPopupDOMWrapper.classList.remove('report-reason-wrapper--show');\n\tcustomReportReason.classList.remove('report-reason-popup__custom-report-reason--show');\n\treportReasonPopup.classList.remove('report-reason-popup--hide');\n\treportReasonValidationError.classList.remove('report-reason-popup__validation-error--show');\n\treportReasonPopupForm.reset();\n};\nconst bootstrapReportReasonPopup = () => {\n\tif (bootstrapUsed) {\n\t\tthrow 'bootstrapReportReasonPopup should be called only once!';\n\t}\n\n\tinitOffClickHandler();\n\tinitReasonList();\n\tinitButtons();\n\tinitPopupContainer();\n\n\tbootstrapUsed = true;\n};\nbootstrapReportReasonPopup.handler = reportReasonFlagButtonHandler;\n\nfunction reportReasonFlagButtonHandler(event) {\n\tif (event.target.name && event.target.name.endsWith(FLAG_BTN_NAME_SUFFIX)) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\thandleFlagClick(event.target);\n\t}\n}\n\nfunction handleFlagClick(target) {\n\tflagButtonDOM = target;\n\tshowReportReasonPopup(target.form.action);\n}\n\nfunction initOffClickHandler() {\n\treportReasonPopupDOMWrapper.addEventListener('click', (event) => {\n\t\tconst checkDOMElementsId = (DOMElement) =>\n\t\t\tDOMElement.id === 'reportReasonPopup' || DOMElement.id === 'reportReasonSuccessInfo';\n\t\tconst clickedOutsidePopup = !event.composedPath().some(checkDOMElementsId);\n\n\t\tif (clickedOutsidePopup) {\n\t\t\thideReportReasonPopup();\n\t\t}\n\t});\n}\n\nfunction initReasonList() {\n\tconst reasonList = reportReasonPopupDOMWrapper.querySelector('#reportReasonList');\n\treasonList.addEventListener('change', ({ target }) => {\n\t\treportReasonValidationError.classList.remove('report-reason-popup__validation-error--show');\n\n\t\tif (reasonList.children[reasonList.children.length - 1].contains(target)) {\n\t\t\tcustomReportReason.classList.add('report-reason-popup__custom-report-reason--show');\n\t\t\tsetTimeout(customReportReason.focus.bind(customReportReason));\n\t\t} else {\n\t\t\tcustomReportReason.classList.remove('report-reason-popup__custom-report-reason--show');\n\t\t}\n\t});\n}\n\nfunction initButtons() {\n\tconst cancelButton = reportReasonPopupDOMWrapper.querySelector('#cancelReportReason');\n\tcancelButton.addEventListener('click', hideReportReasonPopup);\n\n\tconst sendButton = reportReasonPopupDOMWrapper.querySelector('#sendReportReason');\n\tsendButton.addEventListener('click', submitForm);\n\n\tconst closeReportReasonSentInfo = reportReasonPopupDOMWrapper.querySelector('#closeReportReasonSentInfo');\n\tcloseReportReasonSentInfo.addEventListener('click', hideReportReasonPopup);\n}\n\nfunction initPopupContainer() {\n\tconst popupContainer = document.querySelector('.qa-body-wrapper');\n\tpopupContainer.appendChild(reportReasonPopupDOMWrapper);\n}\n\nfunction submitForm(event) {\n\tevent.preventDefault();\n\n\tconst sendButton = event.target;\n\tsendButton.blur();\n\n\tconst isFormValid = validateForm(sendButton);\n\tif (!isFormValid) {\n\t\treturn;\n\t}\n\n\ttoggleSendWaitingState(sendButton, true);\n\n\tconst formData = prepareFormData();\n\tsendAjax(formData).then(\n\t\t(response) => {\n\t\t\tconsole.warn('response:', response);\n\t\t\tonAjaxSuccess(response, formData, sendButton);\n\t\t},\n\t\t(ajaxError) => onAjaxError(sendButton, ajaxError)\n\t);\n}\n\nfunction onAjaxSuccess(response, formData, sendButton) {\n\ttoggleSendWaitingState(sendButton, false);\n\tupdateCurrentPostFlags(response.currentFlags, formData);\n\tswapElement(\n\t\tflagButtonDOM,\n\t\tgetUnFlagButtonHTML({\n\t\t\tpostType: formData.postType,\n\t\t\tquestionId: formData.questionId,\n\t\t\tpostId: formData.postId,\n\t\t\tparentId: getPostParentId(),\n\t\t})\n\t);\n\tshowSuccessPopup();\n}\n\nfunction onAjaxError(sendButton, ajaxError) {\n\ttoggleSendWaitingState(sendButton, false);\n\t// TODO: add proper error handling\n\tconsole.warn('ajaxError:', ajaxError);\n}\n\nfunction validateForm(sendButton) {\n\tconst isAnyFormElementUsed = [...requirableFormElements].some((element) => {\n\t\tconst isCheckedRadioInput = element.type === 'radio' && element.value !== 'custom' && element.checked;\n\t\tconst isFilledTextArea = element.tagName.toLowerCase() === 'textarea' && element.value;\n\n\t\treturn isCheckedRadioInput || isFilledTextArea;\n\t});\n\n\tif (!isAnyFormElementUsed) {\n\t\tnotifyAboutValidationError(sendButton);\n\t}\n\n\treturn isAnyFormElementUsed;\n}\n\nfunction notifyAboutValidationError(sendButton) {\n\treportReasonValidationError.classList.add('report-reason-popup__validation-error--show');\n\tsendButton.classList.add('report-reason-popup__button--save--validation-blink');\n\tsetTimeout(() => {\n\t\tsendButton.classList.remove('report-reason-popup__button--save--validation-blink');\n\t}, 1000);\n}\n\nfunction prepareFormData() {\n\tconst reportMetaData = reportFlagMap.collectForumPostMetaData();\n\tconst [reasonId, notice] = new FormData(reportReasonPopupForm).getAll('reportReason');\n\n\treturn {\n\t\t...reportMetaData,\n\t\treasonId,\n\t\tnotice,\n\t\treportType: 'addFlag',\n\t};\n}\n\nfunction toggleSendWaitingState(buttonReference, isWaiting) {\n\tif (isWaiting) {\n\t\tbuttonReference.disabled = true;\n\t\twindow.qa_show_waiting_after(buttonReference, true);\n\t} else {\n\t\twindow.qa_hide_waiting(buttonReference);\n\t\tbuttonReference.disabled = false;\n\t}\n}\n\nfunction updateCurrentPostFlags(currentFlagsHTML, { postType, postId }) {\n\tconst flagsMetadataWrapper =\n\t\tpostType === 'q' ? questionViewMeta : document.querySelector(`#${postType}${postId} .qa-${postType}-item-meta`);\n\tconst targetElementSelector = `.qa-${postType}-item-flags`;\n\tconst targetElement = flagsMetadataWrapper.querySelector(targetElementSelector);\n\n\tif (targetElement) {\n\t\t/*swapElement(targetElement, currentFlagsHTML);*/\n\t\ttargetElement.outerHTML = currentFlagsHTML;\n\t} else {\n\t\tconst responseAsDOM = new DOMParser()\n\t\t\t.parseFromString(currentFlagsHTML, 'text/html')\n\t\t\t.querySelector(targetElementSelector);\n\t\tflagsMetadataWrapper.appendChild(responseAsDOM);\n\t}\n}\n\nfunction showSuccessPopup() {\n\treportReasonPopup.classList.add('report-reason-popup--hide');\n\treportReasonSuccessInfo.classList.add('report-reason-popup', 'report-reason-popup__success-info--show');\n}\n\nfunction getPostParentId() {\n\tconst parentElement = flagButtonDOM.closest('[id*=\"_list\"]');\n\n\tif (!parentElement) {\n\t\treturn null;\n\t}\n\n\treturn parentElement.id.slice(1, parentElement.id.indexOf('_'));\n}\n\nexport default bootstrapReportReasonPopup;\n","import { elementsHTMLMap } from './misc';\n\nconst reportReasonPopupDOMWrapper = (() => {\n\tconst listItemsDOM = Object.entries(FLAG_REASONS_METADATA.REASON_LIST).reduce(\n\t\t(listItems, [reasonKey, reasonValue], index, flagReasonsCollection) => {\n\t\t\tconst isLast = index === flagReasonsCollection.length - 1;\n\t\t\tconst textAreaDOM = isLast && elementsHTMLMap.get('textarea');\n\n\t\t\treturn (\n\t\t\t\tlistItems +\n\t\t\t\telementsHTMLMap.get('getListItem')({\n\t\t\t\t\treasonKey,\n\t\t\t\t\treasonValue,\n\t\t\t\t\tindex,\n\t\t\t\t\tisLast,\n\t\t\t\t\ttextAreaDOM,\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\t\t''\n\t);\n\n\tconst popupWrapper = document.createElement('div');\n\tpopupWrapper.classList.add('report-reason-wrapper');\n\tpopupWrapper.innerHTML = elementsHTMLMap.get('getPopupWrapper')(listItemsDOM);\n\n\treturn popupWrapper;\n})();\n\nconst reportReasonPopupDOMReferences = {\n\treportReasonPopup: reportReasonPopupDOMWrapper.querySelector('#reportReasonPopup'),\n\treportReasonPopupForm: reportReasonPopupDOMWrapper.querySelector('form'),\n\tcustomReportReason: reportReasonPopupDOMWrapper.querySelector('#customReportReason'),\n\treportReasonSuccessInfo: reportReasonPopupDOMWrapper.querySelector('#reportReasonSuccessInfo'),\n\trequirableFormElements: reportReasonPopupDOMWrapper.querySelectorAll('[data-requirable=\"true\"]'),\n\treportReasonValidationError: reportReasonPopupDOMWrapper.querySelector('#reportReasonValidationError'),\n};\n\nexport { reportReasonPopupDOMReferences, reportReasonPopupDOMWrapper };\n","function getUnFlagButtonHTML({ postType, questionId, postId, parentId }) {\n\tlet namePrefix = postType + postId;\n\tlet onclick = '';\n\n\tconst nameSuffix = '_dounflag';\n\tconst value = 'wycofaj zgłoszenie';\n\tconst title = 'Wycofaj zgłoszenie tej treści';\n\tconst type = 'submit';\n\tconst clazz = 'qa-form-light-button qa-form-light-button-unflag';\n\n\tswitch (postType) {\n\t\tcase 'q': {\n\t\t\tonclick = 'qa_show_waiting_after(this, false)';\n\t\t\tnamePrefix = postType;\n\t\t\tbreak;\n\t\t}\n\t\tcase 'a': {\n\t\t\tonclick = `return qa_answer_click(${postId}, ${questionId}, this);`;\n\t\t\tbreak;\n\t\t}\n\t\tcase 'c': {\n\t\t\tonclick = `return qa_comment_click(${postId}, ${questionId}, ${parentId}, this);`;\n\t\t\tbreak;\n\t\t}\n\t\tdefault: {\n\t\t\tthrow new Error(`Unrecognized postType: ${postType} for questionId: ${questionId} and postId: ${postId}`);\n\t\t}\n\t}\n\n\treturn `\n\t\t<input name=\"${namePrefix}${nameSuffix}\" \n\t\t\tonclick=\"${onclick}\"\n\t\t\tvalue=\"${value}\"\n\t\t\ttitle=\"${title}\"\n\t\t\ttype=\"${type}\" \n\t\t\tclass=\"${clazz}\">\n\t`;\n}\n\nexport default getUnFlagButtonHTML;\n"],"sourceRoot":""}