{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./src/ajaxService.js","webpack:///./src/misc.js","webpack:///./src/popupController.js","webpack:///./src/popupFactory.js"],"names":["AJAX_TIMEOUT_REASON","TIMEOUT","URL","CONTENT_TYPE","sendAjax","data","Promise","resolve","reject","timeoutId","setTimeout","fetch","method","headers","body","JSON","stringify","then","value","clearTimeout","console","warn","json","FLAG_REASONS_METADATA","NOTICE_LENGTH","POPUP_LABELS","swapElement","referenceNode","html","tmpParent","document","createElement","innerHTML","newElement","removeChild","firstElementChild","parentNode","insertBefore","remove","elementsHTMLMap","Map","reasonKey","reasonValue","index","isLast","textAreaDOM","listItemsDOM","HEADER","NO_REASON_CHECKED","CANCEL","SEND","REPORT_SENT","CLOSE","reportReasonPopupDOMWrapper","reportReasonPopup","reportReasonPopupDOMReferences","reportReasonPopupForm","customReportReason","reportReasonSuccessInfo","requirableFormElements","reportReasonValidationError","questionViewMeta","querySelector","BTN_NAME_SUFFIXES_REGEX","FLAG_BTN_NAME_SUFFIX","reportFlagMap","regex","question","answer","comment","doComment","getPostIdFromInputName","postType","inputName","match","postId","recognizeInputKindByName","Object","entries","find","regexKey","regexValue","test","mappedInputNameRegexKey","collectForumPostMetaData","flagButtonDOM","name","postRootSource","form","getAttribute","postMetaData","questionId","split","slice","bootstrapUsed","showReportReasonPopup","originalFormActionAttribute","action","classList","add","hideReportReasonPopup","reset","bootstrapReportReasonPopup","initOffClickHandler","initReasonList","initButtons","initPopupContainer","handler","reportReasonFlagButtonHandler","event","target","endsWith","preventDefault","stopPropagation","handleFlagClick","addEventListener","checkDOMElementsId","DOMElement","id","clickedOutsidePopup","composedPath","some","reasonList","children","length","contains","focus","bind","cancelButton","sendButton","submitForm","closeReportReasonSentInfo","popupContainer","appendChild","blur","isFormValid","validateForm","toggleSendWaitingState","formData","prepareFormData","response","onAjaxSuccess","ajaxError","onAjaxError","updateCurrentPostFlags","currentFlags","getUnflagButtonHTML","parentId","getPostParentId","showSuccessPopup","isAnyFormElementUsed","element","isCheckedRadioInput","type","checked","isFilledTextArea","tagName","toLowerCase","notifyAboutValidationError","reportMetaData","FormData","getAll","reasonId","notice","reportType","buttonReference","isWaiting","disabled","window","qa_show_waiting_after","qa_hide_waiting","currentFlagsHTML","flagsMetadataWrapper","targetElementSelector","targetElement","outerHTML","responseAsDOM","DOMParser","parseFromString","parentElement","closest","parentElementPostId","indexOf","error","REASON_LIST","reduce","listItems","flagReasonsCollection","get","popupWrapper","querySelectorAll"],"mappings":"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","file":"0.script.js","sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","const AJAX_TIMEOUT_REASON = 'AJAX_TIMEOUT';\nconst TIMEOUT = 5000;\n\nconst URL = '/report-flag';\nconst CONTENT_TYPE = 'application/json';\n\nconst sendAjax = (data) => {\n  return new Promise((resolve, reject) => {\n    const timeoutId = setTimeout(() => {\n      reject(AJAX_TIMEOUT_REASON);\n    }, TIMEOUT);\n\n    fetch(URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': CONTENT_TYPE,\n      },\n      body: JSON.stringify(data),\n    }).then(async (value) => {\n      clearTimeout(timeoutId);\n\n      // let text = null;\n      // if (purpose === AJAX_PURPOSE.UN_FLAG) {\n      //   try {\n      //     text = await value.text();\n      //   } catch ( e ) {\n      //     console.error( 'value.text not worked... /e: ', e );\n      //   }\n      // }\n\n      console.warn('fetch response: ', value /*, ' /?:', text*/);\n\n      // const resolveValue = purpose === AJAX_PURPOSE.FLAG ? value.json() : 'ok';\n      resolve(value.json());\n    });\n  });\n};\n\nexport default sendAjax;\n","const { NOTICE_LENGTH, POPUP_LABELS } = FLAG_REASONS_METADATA;\n\nexport const swapElement = (referenceNode, html) => {\n  const tmpParent = document.createElement('div');\n  tmpParent.innerHTML = html;\n\n  const newElement = tmpParent.removeChild(tmpParent.firstElementChild);\n  referenceNode.parentNode.insertBefore(newElement, referenceNode);\n  referenceNode.remove();\n\n  // return newElement;\n};\n\nexport const elementsHTMLMap = new Map([\n  [\n    'textarea',\n    `<textarea id=\"customReportReason\"\n        class=\"report-reason-popup__custom-report-reason\"\n        name=\"reportReason\"\n        data-requirable=\"true\"\n        maxlength=\"${NOTICE_LENGTH}\"\n        rows=\"3\"\n        cols=\"47\"></textarea>`,\n  ],\n  [\n    'getListItem',\n    ({ reasonKey, reasonValue, index, isLast, textAreaDOM }) => {\n      return `\n            <!-- TODO: handle checking inputs while tabbing -->\n            <li tabindex=\"1\">\n                <label for=\"${reasonKey}\">\n                    <input id=\"${reasonKey}\" \n                            type=\"radio\" \n                            value=\"${index}\" \n                            name=\"reportReason\" \n                            data-requirable=\"true\">\n                    ${reasonValue}\n                </label>\n                ${isLast ? textAreaDOM : ''}\n            </li>\n        `;\n    },\n  ],\n  [\n    'getPopupWrapper',\n    (listItemsDOM) => {\n      return `\n            <div id=\"reportReasonPopup\" class=\"report-reason-popup\">\n                <p>${POPUP_LABELS.HEADER}</p>\n                \n                <form method=\"post\" class=\"report-reason-popup__form\">\n                    <ul id=\"reportReasonList\" class=\"report-reason-popup__list\">${listItemsDOM}</ul>\n                \n                    <p id=\"reportReasonValidationError\" class=\"report-reason-popup__validation-error\">${POPUP_LABELS.NO_REASON_CHECKED}</p>\n                    \n                    <!-- TODO: why its input not button? -->\n                    <input id=\"cancelReportReason\" type=\"button\" value=\"${POPUP_LABELS.CANCEL}\" class=\"report-reason-popup__button report-reason-popup__button--cancel\">\n                    <button id=\"sendReportReason\" type=\"submit\" class=\"report-reason-popup__button report-reason-popup__button--save\">${POPUP_LABELS.SEND}</button>\n                </form>\n            </div>\n            <div id=\"reportReasonSuccessInfo\" class=\"report-reason-popup__success-info\">\n                ${POPUP_LABELS.REPORT_SENT}\n                <button id=\"closeReportReasonSentInfo\" class=\"report-reason-popup__button report-reason-popup__button--close\" type=\"button\">${POPUP_LABELS.CLOSE}</button>\n            </div>`;\n    },\n  ],\n]);\n","import sendAjax from './ajaxService';\nimport {\n  reportReasonPopupDOMWrapper,\n  reportReasonPopupDOMReferences,\n} from './popupFactory';\nconsole.warn('reportReasonPopupDOMWrapper: ', reportReasonPopupDOMWrapper);\nimport { swapElement } from './misc';\n\nconst {\n  reportReasonPopup,\n  reportReasonPopupForm,\n  customReportReason,\n  reportReasonSuccessInfo,\n  requirableFormElements,\n  reportReasonValidationError,\n} = reportReasonPopupDOMReferences;\nconst questionViewMeta = document.querySelector('.qa-q-view-meta');\n\nconst BTN_NAME_SUFFIXES_REGEX = /do(clear|un)?flag[s]?/;\nconst FLAG_BTN_NAME_SUFFIX = 'doflag';\n// const doCommentInputNameSuffix = '_docomment';\nconst reportFlagMap = {\n  regex: {\n    question: /q_doflag/,\n    answer: /^a(\\d+)_doflag/,\n    comment: /^c(\\d+)_doflag/,\n    doComment: /^a(\\d+)_docomment/,\n  },\n  getPostIdFromInputName(postType, inputName) {\n    // TODO: check if it works (changed exec to match)...\n    const [, postId] = inputName.match(this.regex[postType]);\n    return postId;\n  },\n  recognizeInputKindByName(inputName) {\n    const [mappedInputNameRegexKey] = Object.entries(\n      this.regex\n    ).find(([regexKey, regexValue]) => regexValue.test(inputName));\n    return mappedInputNameRegexKey;\n  },\n  collectForumPostMetaData() {\n    const postType = this.recognizeInputKindByName(flagButtonDOM.name);\n    const postRootSource = flagButtonDOM.form.getAttribute('action');\n    const postMetaData = {\n      questionId: postRootSource.split('/')[1],\n      postType: postType.slice(0, 1),\n    };\n    postMetaData.postId =\n      this.getPostIdFromInputName(postType, flagButtonDOM.name) ||\n      postMetaData.questionId;\n\n    // if (postType === 'answer') {\n    //   postMetaData.answerId = this.getPostIdFromInputName(\n    //     'answer',\n    //     flagButtonDOM.name\n    //   );\n    // } else if (postType === 'comment') {\n\n    // const doCommentInputDOM = flagButtonDOM.parentElement.querySelector(\n    //   `[name*=\"${doCommentInputNameSuffix}\"]`\n    // );\n    // postMetaData.answerId = this.getPostIdFromInputName(\n    //   'doComment',\n    //   doCommentInputDOM.name\n    // );\n\n    //   postMetaData.commentId = this.getPostIdFromInputName(\n    //     'comment',\n    //     flagButtonDOM.name\n    //   );\n    // }\n\n    return postMetaData;\n  },\n};\n\nlet bootstrapUsed = false;\nlet flagButtonDOM = null;\n\nconst showReportReasonPopup = (originalFormActionAttribute) => {\n  reportReasonPopupForm.action = originalFormActionAttribute;\n  reportReasonPopupDOMWrapper.classList.add('report-reason-wrapper--show');\n};\nconst hideReportReasonPopup = () => {\n  reportReasonSuccessInfo.classList.remove(\n    'report-reason-popup__success-info--show'\n  );\n  reportReasonPopupDOMWrapper.classList.remove('report-reason-wrapper--show');\n  customReportReason.classList.remove(\n    'report-reason-popup__custom-report-reason--show'\n  );\n  reportReasonPopup.classList.remove('report-reason-popup--hide');\n  reportReasonValidationError.classList.remove(\n    'report-reason-popup__validation-error--show'\n  );\n  reportReasonPopupForm.reset();\n};\nconst bootstrapReportReasonPopup = () => {\n  if (bootstrapUsed) {\n    throw 'bootstrapReportReasonPopup should be called only once!';\n  }\n\n  initOffClickHandler();\n  initReasonList();\n  initButtons();\n  initPopupContainer();\n\n  bootstrapUsed = true;\n};\nbootstrapReportReasonPopup.handler = reportReasonFlagButtonHandler;\n\nfunction reportReasonFlagButtonHandler(event) {\n  if (event.target.name && event.target.name.endsWith(FLAG_BTN_NAME_SUFFIX)) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    handleFlagClick(event.target);\n  }\n}\n\nfunction handleFlagClick(target) {\n  flagButtonDOM = target;\n  showReportReasonPopup(target.form.action);\n}\n\nfunction initOffClickHandler() {\n  reportReasonPopupDOMWrapper.addEventListener('click', (event) => {\n    const checkDOMElementsId = (DOMElement) =>\n      DOMElement.id === 'reportReasonPopup' ||\n      DOMElement.id === 'reportReasonSuccessInfo';\n    const clickedOutsidePopup = !event.composedPath().some(checkDOMElementsId);\n\n    if (clickedOutsidePopup) {\n      hideReportReasonPopup();\n    }\n  });\n}\n\nfunction initReasonList() {\n  const reasonList = reportReasonPopupDOMWrapper.querySelector(\n    '#reportReasonList'\n  );\n  reasonList.addEventListener('change', ({ target }) => {\n    reportReasonValidationError.classList.remove(\n      'report-reason-popup__validation-error--show'\n    );\n\n    if (reasonList.children[reasonList.children.length - 1].contains(target)) {\n      customReportReason.classList.add(\n        'report-reason-popup__custom-report-reason--show'\n      );\n      setTimeout(customReportReason.focus.bind(customReportReason));\n    } else {\n      customReportReason.classList.remove(\n        'report-reason-popup__custom-report-reason--show'\n      );\n    }\n  });\n}\n\nfunction initButtons() {\n  const cancelButton = reportReasonPopupDOMWrapper.querySelector(\n    '#cancelReportReason'\n  );\n  cancelButton.addEventListener('click', hideReportReasonPopup);\n\n  const sendButton = reportReasonPopupDOMWrapper.querySelector(\n    '#sendReportReason'\n  );\n  sendButton.addEventListener('click', submitForm);\n\n  const closeReportReasonSentInfo = reportReasonPopupDOMWrapper.querySelector(\n    '#closeReportReasonSentInfo'\n  );\n  closeReportReasonSentInfo.addEventListener('click', hideReportReasonPopup);\n}\n\nfunction initPopupContainer() {\n  const popupContainer = document.querySelector('.qa-body-wrapper');\n  popupContainer.appendChild(reportReasonPopupDOMWrapper);\n}\n\nfunction submitForm(event) {\n  event.preventDefault();\n\n  const sendButton = event.target;\n  sendButton.blur();\n\n  const isFormValid = validateForm(sendButton);\n  if (!isFormValid) {\n    return;\n  }\n\n  toggleSendWaitingState(sendButton, true);\n\n  const formData = prepareFormData();\n  sendAjax(formData).then(\n    (response) => {\n      console.warn('response:', response);\n      onAjaxSuccess(response, formData, sendButton);\n    },\n    (ajaxError) => onAjaxError(sendButton, ajaxError)\n  );\n}\n\nfunction onAjaxSuccess(response, formData, sendButton) {\n  toggleSendWaitingState(sendButton, false);\n  updateCurrentPostFlags(response.currentFlags, formData);\n  swapElement(\n    flagButtonDOM,\n    getUnflagButtonHTML({\n      postType: formData.postType,\n      questionId: formData.questionId,\n      postId: formData.postId,\n      parentId: getPostParentId(),\n    })\n  );\n  showSuccessPopup();\n}\n\nfunction onAjaxError(sendButton, ajaxError) {\n  toggleSendWaitingState(sendButton, false);\n  // TODO: add proper error handling\n  console.warn('ajaxError:', ajaxError);\n}\n\nfunction validateForm(sendButton) {\n  const isAnyFormElementUsed = [...requirableFormElements].some((element) => {\n    const isCheckedRadioInput =\n      element.type === 'radio' && element.value !== 'custom' && element.checked;\n    const isFilledTextArea =\n      element.tagName.toLowerCase() === 'textarea' && element.value;\n\n    return isCheckedRadioInput || isFilledTextArea;\n  });\n\n  if (!isAnyFormElementUsed) {\n    notifyAboutValidationError(sendButton);\n  }\n\n  return isAnyFormElementUsed;\n}\n\nfunction notifyAboutValidationError(sendButton) {\n  reportReasonValidationError.classList.add(\n    'report-reason-popup__validation-error--show'\n  );\n  sendButton.classList.add(\n    'report-reason-popup__button--save--validation-blink'\n  );\n  setTimeout(() => {\n    sendButton.classList.remove(\n      'report-reason-popup__button--save--validation-blink'\n    );\n  }, 1000);\n}\n\nfunction prepareFormData() {\n  const reportMetaData = reportFlagMap.collectForumPostMetaData();\n  const [reasonId, notice] = new FormData(reportReasonPopupForm).getAll(\n    'reportReason'\n  );\n\n  return {\n    ...reportMetaData,\n    reasonId,\n    notice,\n    reportType: 'addFlag',\n  };\n}\n\nfunction toggleSendWaitingState(buttonReference, isWaiting) {\n  if (isWaiting) {\n    buttonReference.disabled = true;\n    window.qa_show_waiting_after(buttonReference, true);\n  } else {\n    window.qa_hide_waiting(buttonReference);\n    buttonReference.disabled = false;\n  }\n}\n\nfunction updateCurrentPostFlags(currentFlagsHTML, { postType, postId }) {\n  const flagsMetadataWrapper =\n    postType === 'q'\n      ? questionViewMeta\n      : document.querySelector(\n          `#${postType}${postId} .qa-${postType}-item-meta`\n        );\n  const targetElementSelector = `.qa-${postType}-item-flags`;\n  const targetElement = flagsMetadataWrapper.querySelector(\n    targetElementSelector\n  );\n\n  if (targetElement) {\n    /*swapElement(targetElement, currentFlagsHTML);*/\n    targetElement.outerHTML = currentFlagsHTML;\n  } else {\n    const responseAsDOM = new DOMParser()\n      .parseFromString(currentFlagsHTML, 'text/html')\n      .querySelector(targetElementSelector);\n    flagsMetadataWrapper.appendChild(responseAsDOM);\n  }\n}\n\nfunction showSuccessPopup() {\n  reportReasonPopup.classList.add('report-reason-popup--hide');\n  reportReasonSuccessInfo.classList.add(\n    'report-reason-popup',\n    'report-reason-popup__success-info--show'\n  );\n}\n\nfunction getPostParentId() {\n  const parentElement = flagButtonDOM.closest('[id*=\"_list\"]');\n\n  if (!parentElement) {\n    return null;\n  }\n\n  const parentElementPostId = parentElement.id.slice(\n    1,\n    parentElement.id.indexOf('_')\n  );\n  return parentElementPostId;\n}\n\nfunction getUnflagButtonHTML({ postType, questionId, postId, parentId }) {\n  switch (postType) {\n    case 'q': {\n      return `\n        <input name=\"q_dounflag\" \n          onclick=\"qa_show_waiting_after(this, false);\" \n          value=\"wycofaj zgłoszenie\" \n          title=\"Wycofaj zgłoszenie tej treści\" \n          type=\"submit\" \n          class=\"qa-form-light-button qa-form-light-button-unflag\">\n      `;\n    }\n    case 'a': {\n      return `\n        <input name=\"a${postId}_dounflag\" \n            onclick=\"return qa_answer_click(${postId}, ${questionId}, this);\" \n            value=\"wycofaj zgłoszenie\" \n            title=\"Wycofaj zgłoszenie tej treści\" \n            type=\"submit\" \n            class=\"qa-form-light-button qa-form-light-button-unflag\">\n      `;\n    }\n    case 'c': {\n      return `\n        <input name=\"c${postId}_dounflag\" \n            onclick=\"return qa_comment_click(${postId}, ${questionId}, ${parentId}, this);\" \n            value=\"wycofaj zgłoszenie\" \n            title=\"Wycofaj zgłoszenie tej treści\" \n            type=\"submit\" \n            class=\"qa-form-light-button qa-form-light-button-unflag\">\n      `;\n    }\n    default: {\n      console.error(\n        'Unrecognized postType!',\n        postType,\n        ' /questionId: ',\n        questionId,\n        ' /postId: ',\n        postId\n      );\n    }\n  }\n}\n\nexport default bootstrapReportReasonPopup;\n","import { elementsHTMLMap } from './misc';\n\nconst reportReasonPopupDOMWrapper = (function () {\n  const listItemsDOM = Object.entries(FLAG_REASONS_METADATA.REASON_LIST).reduce(\n    (listItems, [reasonKey, reasonValue], index, flagReasonsCollection) => {\n      // const reasonItemId = `reportReasonItem${index}`;\n      const isLast = index === flagReasonsCollection.length - 1;\n      const textAreaDOM = isLast && elementsHTMLMap.get('textarea');\n\n      return (\n        listItems +\n        elementsHTMLMap.get('getListItem')({\n          reasonKey,\n          reasonValue,\n          index,\n          isLast,\n          textAreaDOM,\n        })\n      );\n    },\n    ''\n  );\n\n  const popupWrapper = document.createElement('div');\n  popupWrapper.classList.add('report-reason-wrapper');\n  popupWrapper.innerHTML = elementsHTMLMap.get('getPopupWrapper')(listItemsDOM);\n\n  return popupWrapper;\n})();\n\nconst reportReasonPopupDOMReferences = {\n  reportReasonPopup: reportReasonPopupDOMWrapper.querySelector(\n    '#reportReasonPopup'\n  ),\n  reportReasonPopupForm: reportReasonPopupDOMWrapper.querySelector('form'),\n  customReportReason: reportReasonPopupDOMWrapper.querySelector(\n    '#customReportReason'\n  ),\n  reportReasonSuccessInfo: reportReasonPopupDOMWrapper.querySelector(\n    '#reportReasonSuccessInfo'\n  ),\n  requirableFormElements: reportReasonPopupDOMWrapper.querySelectorAll(\n    '[data-requirable=\"true\"]'\n  ),\n  reportReasonValidationError: reportReasonPopupDOMWrapper.querySelector(\n    '#reportReasonValidationError'\n  ),\n};\n\nexport { reportReasonPopupDOMReferences, reportReasonPopupDOMWrapper };\n"],"sourceRoot":""}